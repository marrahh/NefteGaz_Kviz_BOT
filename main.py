import telebot
from telebot import types

bot = telebot.TeleBot('TOKEN')

user_data = {}
CHAT_ID = -1001581188819

questions_basics_novice = [
    {'text': 'Нефть - это ...',
     'options': ['Твердое вещество', 'Жидкость', 'Газ', 'Минерал'],
     'correct_answer': 'Жидкость'},

    {'text': 'Основной компонент природного газа - это...',
     'options': ['Кислород', 'Углекислый газ', 'Метан', 'Водород'],
     'correct_answer': 'Метан'},

    {'text': 'Нефть и газ добывают из...',
     'options': ['Облаков', 'Рек', 'Земли', 'Гор'],
     'correct_answer': 'Земли'},

    {'text': 'Что из перечисленного НЕ является продуктом переработки нефти?',
     'options': ['Бензин', 'Дизельное топливо', 'Керосин', 'Вода'],
     'correct_answer': 'Вода'},

    {'text': 'Нефть и газ относятся к...',
     'options': ['Возобновляемым источникам энергии', 'Невозобновляемым источникам энергии', 'Альтернативным источникам энергии', 'Бесконечным источникам энергии'],
     'correct_answer': 'Невозобновляемым источникам энергии'}
]

questions_basics_medium = [
    {'text': 'Какой процесс лежит в основе формирования нефти и природного газа?',
     'options': ['Вулканизм', 'Фотосинтез', 'Диагенез органического вещества', 'Метаморфизм горных пород'],
     'correct_answer': 'Диагенез органического вещества'},

    {'text': 'Что такое "плотность" нефти, и в каких единицах она обычно измеряется?',
     'options': ['Масса вещества в единице объема, кг/м3', 'Степень вязкости, в сантипуазах', 'Количество серы в процентах', 'Содержание воды, в промилле'],
     'correct_answer': 'Масса вещества в единице объема, кг/м3'},

    {'text': 'Что такое "конденсат" в контексте добычи природного газа?',
     'options': ['Жидкая фракция, выпадающая при снижении температуры и давления газа', 'Твердые примеси в газе', 'Водяной пар, содержащийся в газе', 'Искусственно добавленные вещества для повышения калорийности газа'],
     'correct_answer': 'Жидкая фракция, выпадающая при снижении температуры и давления газа'},

    {'text': 'Что такое "API gravity" и для чего она используется?',
     'options': ['Мера плотности нефти, используемая для определения её стоимости', 'Мера содержания серы в нефти', 'Мера вязкости нефти', 'Мера радиоактивности нефти'],
     'correct_answer': 'Мера плотности нефти, используемая для определения её стоимости'},

    {'text': 'Какие основные типы залежей нефти и газа существуют?',
     'options': ['Антиклинальные, синклинальные, моноклинальные', 'Пластовые, массивные, литологически ограниченные', 'Вулканические, осадочные, метаморфические', 'Открытые, закрытые, полузакрытые'],
     'correct_answer': 'Пластовые, массивные, литологически ограниченные'}
]

questions_basics_expert = [
    {'text': 'Каковы современные представления о роли абиогенного синтеза углеводородов в формировании крупных нефтяных месторождений?',
     'options': ['Абиогенный синтез является основным фактором формирования большинства крупных месторождений.',
                 'Абиогенный синтез играет незначительную роль в формировании большинства месторождений, но может быть важен в специфических геологических условиях.',
                 'Абиогенный синтез полностью опровергнут современными исследованиями.',
                 'Роль абиогенного синтеза признается только для газовых месторождений, но не для нефтяных.'],
     'correct_answer': 'Абиогенный синтез играет незначительную роль в формировании большинства месторождений, но может быть важен в специфических геологических условиях.'},

    {'text': 'Каким образом изотопный состав углерода в нефти и газе используется для определения их происхождения и возраста?',
     'options': ['По соотношению изотопов C12 и C14.', 'По соотношению стабильных изотопов C12 и C13.',
                 'По наличию радиоактивных изотопов углерода.', 'Изотопный состав углерода не используется для этих целей.'],
     'correct_answer': 'По соотношению стабильных изотопов C12 и C13.'},

    {'text': 'Что такое "газогидраты" и каковы перспективы их освоения как источника энергии?',
     'options': ['Твердые соединения газа и воды, образующиеся при высоких температурах и давлениях.',
                 'Жидкие углеводороды, образующиеся при низких температурах.',
                 'Твердые соединения газа и воды, образующиеся при низких температурах и высоких давлениях.',
                 'Искусственно созданные вещества, используемые для транспортировки газа.'],
     'correct_answer': 'Твердые соединения газа и воды, образующиеся при низких температурах и высоких давлениях.'},

    {'text': 'Какие факторы определяют категорию нефти как "легкая", "средняя" или "тяжелая", и какое значение это имеет для её переработки?',
     'options': ['Содержание серы и воды.', 'Плотность и вязкость.', 'Цвет и запах.', 'Географическое происхождение.'],
     'correct_answer': 'Плотность и вязкость.'},

    {'text': 'Объясните концепцию "пика нефти" (Peak Oil) и приведите аргументы "за" и "против" её неизбежного наступления.',
     'options': ['Концепция "пика нефти" - это теория о неизбежном истощении мировых запасов нефти.',
                 'Концепция "пика нефти" - это теория о достижении максимального уровня добычи нефти, после которого начнется необратимый спад.',
                 'Концепция "пика нефти" - это теория о снижении цен на нефть из-за переизбытка предложения.',
                 'Концепция "пика нефти" - это теория о переходе на альтернативные источники энергии.'],
     'correct_answer': 'Концепция "пика нефти" - это теория о достижении максимального уровня добычи нефти, после которого начнется необратимый спад.'}
]

questions_extraction_novice = [
    {'text': 'Как называется процесс извлечения нефти и газа из земли?',
     'options': ['Геологоразведка', 'Добыча', 'Переработка', 'Транспортировка'],
     'correct_answer': 'Добыча'},

    {'text': 'Что такое буровая вышка?',
     'options': ['Здание для хранения нефти', 'Сооружение для бурения скважин', 'Транспортное средство для перевозки нефти', 'Лаборатория для анализа нефти'],
     'correct_answer': 'Сооружение для бурения скважин'},

    {'text': 'Какой основной инструмент используется для бурения нефтяных и газовых скважин?',
     'options': ['Лопата', 'Сверло', 'Молоток', 'Пила'],
     'correct_answer': 'Сверло'},

    {'text': 'Что означает аббревиатура "ГРП" в нефтедобыче?',
     'options': ['Геологическая Разведка Пластов', 'Гидравлический Разрыв Пласта', 'Газовый Режим Пласта', 'Глубокая Разработка Пластов'],
     'correct_answer': 'Гидравлический Разрыв Пласта'},

    {'text': 'Как называется профессия человека, работающего на буровой вышке?',
     'options': ['Геолог', 'Бурильщик', 'Химик', 'Инженер'],
     'correct_answer': 'Бурильщик'}
]

questions_extraction_medium = [
    {'text': 'Что такое "дебит скважины" и в каких единицах он измеряется?',
     'options': ['Глубина скважины, в метрах', 'Количество добытой нефти или газа за единицу времени, в тоннах/сутки или м3/сутки',
                 'Давление в скважине, в атмосферах', 'Диаметр скважины, в дюймах'],
     'correct_answer': 'Количество добытой нефти или газа за единицу времени, в тоннах/сутки или м3/сутки'},

    {'text': 'Какие основные методы эксплуатации нефтяных скважин существуют?',
     'options': ['Фонтанный, насосный, газлифтный', 'Открытый, закрытый, комбинированный', 'Сухой, мокрый, полусухой',
                 'Вертикальный, горизонтальный, наклонно-направленный'],
     'correct_answer': 'Фонтанный, насосный, газлифтный'},

    {'text': 'Что такое "НКТ" в нефтедобыче и для чего они используются?',
     'options': ['Насосно-компрессорные трубы, для подъема жидкости из скважины', 'Наклонно-каротажные технологии, для исследования скважин',
                 'Нормативно-контрольная документация, регламентирующая процессы добычи', 'Наземный комплекс телеметрии, для контроля параметров скважины'],
     'correct_answer': 'Насосно-компрессорные трубы, для подъема жидкости из скважины'},

    {'text': 'Каковы основные цели проведения гидроразрыва пласта (ГРП)?',
     'options': ['Увеличение дебита скважины за счет создания трещин в пласте', 'Укрепление стенок скважины', 'Очистка скважины от загрязнений',
                 'Снижение давления в пласте'],
     'correct_answer': 'Увеличение дебита скважины за счет создания трещин в пласте'},

    {'text': 'Что такое "газовый фактор" нефти и какое значение он имеет при разработке месторождения?',
     'options': ['Количество газа, растворенного в нефти, при пластовых условиях', 'Количество газа, выделяемого при переработке нефти',
                 'Содержание сероводорода в газе', 'Давление газа в пласте'],
     'correct_answer': 'Количество газа, растворенного в нефти, при пластовых условиях'}
]

questions_extraction_expert = [
    {'text': 'Опишите современные методы интенсификации добычи на зрелых месторождениях с высокой степенью обводненности, и какие факторы определяют их эффективность?',
     'options': ['Только закачка воды или газа для поддержания пластового давления.',
                 'Использование методов увеличения нефтеотдачи пластов (МУО), таких как закачка полимеров, ПАВ, щелочи, и их комбинаций. Эффективность зависит от геолого-физических характеристик пласта, свойств нефти и закачиваемого агента.',
                 'Консервация скважин и прекращение добычи.',
                 'Только бурение новых скважин.'],
     'correct_answer': 'Использование методов увеличения нефтеотдачи пластов (МУО), таких как закачка полимеров, ПАВ, щелочи, и их комбинаций. Эффективность зависит от геолого-физических характеристик пласта, свойств нефти и закачиваемого агента.'},

    {'text': 'Какие существуют современные технологии для мониторинга и управления разработкой трудноизвлекаемых запасов (ТрИЗ), таких как сланцевая нефть и газ, и каковы их ограничения?',
     'options': ['Только традиционные методы геофизических исследований скважин (ГИС).',
                 'Использование распределенных волоконно-оптических систем (DTS, DAS), микросейсмического мониторинга, химических трассеров. Ограничения связаны со стоимостью, интерпретацией данных и масштабом исследований.',
                 'Только математическое моделирование пласта.',
                 'Отсутствуют эффективные технологии мониторинга ТрИЗ.'],
     'correct_answer': 'Использование распределенных волоконно-оптических систем (DTS, DAS), микросейсмического мониторинга, химических трассеров. Ограничения связаны со стоимостью, интерпретацией данных и масштабом исследований.'},

    {'text': 'В чем заключаются основные экологические риски, связанные с добычей нефти и газа на шельфе Арктики, и какие технологии используются для их минимизации?',
     'options': ['Отсутствуют значительные экологические риски.',
                 'Риски разливов нефти, загрязнения морской среды, нарушения экосистем. Используются технологии предотвращения аварий, системы быстрого реагирования, экологический мониторинг.',
                 'Только риски, связанные с изменением климата.',
                 'Риски, связанные только с шумовым загрязнением.'],
     'correct_answer': 'Риски разливов нефти, загрязнения морской среды, нарушения экосистем. Используются технологии предотвращения аварий, системы быстрого реагирования, экологический мониторинг.'},

    {'text': 'Каковы особенности разработки месторождений с высоким содержанием сероводорода (H2S) и меркаптанов, и какие технологии используются для обеспечения безопасности и предотвращения коррозии оборудования?',
     'options': ['Нет особых особенностей, используются стандартные методы добычи.',
                 'Использование специальных материалов, устойчивых к коррозии, добавление ингибиторов коррозии, строгий контроль за содержанием H2S, системы обнаружения утечек газа.',
                 'Только использование респираторов для защиты персонала.',
                 'Отказ от разработки таких месторождений.'],
     'correct_answer': 'Использование специальных материалов, устойчивых к коррозии, добавление ингибиторов коррозии, строгий контроль за содержанием H2S, системы обнаружения утечек газа.'},

    {'text': 'Опишите принципы работы и преимущества интеллектуальных (smart) скважин по сравнению с традиционными скважинами, и какие данные они позволяют получать в режиме реального времени?',
     'options': ['Интеллектуальные скважины – это скважины с более глубоким бурением.',
                 'Интеллектуальные скважины оснащены датчиками и клапанами, позволяющими контролировать и оптимизировать добычу из разных зон пласта в режиме реального времени. Данные о давлении, температуре, дебите, обводненности.',
                 'Интеллектуальные скважины позволяют только удаленно открывать и закрывать задвижки.',
                 'Нет никаких преимуществ, это просто маркетинговый ход.'],
     'correct_answer': 'Интеллектуальные скважины оснащены датчиками и клапанами, позволяющими контролировать и оптимизировать добычу из разных зон пласта в режиме реального времени. Данные о давлении, температуре, дебите, обводненности.'}
]

questions_processing_novice = [
    {
        'text': 'Что делают с нефтью после добычи?',
        'options': ['Сразу заливают в бензобак машины',
                    'Отправляют на переработку',
                    'Выливают обратно в землю',
                    'Используют для отопления дома'],
        'correct_answer': 'Отправляют на переработку'
    },
    {
        'text': 'Какой продукт получают при переработке нефти?',
        'options': ['Только бензин',
                    'Только дизельное топливо',
                    'Различные виды топлива и другие продукты',
                    'Только пластик'],
        'correct_answer': 'Различные виды топлива и другие продукты'
    },
    {
        'text': 'Как называется установка, где перерабатывают нефть?',
        'options': ['Шахта', 'Завод', 'Нефтеперерабатывающий завод', 'Буровая вышка'],
        'correct_answer': 'Нефтеперерабатывающий завод'
    },
    {
        'text': 'Что такое бензин?',
        'options': ['Продукт для мытья машин',
                    'Топливо для самолетов',
                    'Топливо для автомобилей',
                    'Вещество для изготовления красок'],
        'correct_answer': 'Топливо для автомобилей'
    },
    {
        'text': 'Какой газ используют для отопления домов и приготовления пищи?',
        'options': ['Кислород', 'Углекислый газ', 'Природный газ', 'Гелий'],
        'correct_answer': 'Природный газ'
    }
]

questions_processing_medium = [
    {
        'text': 'Какой процесс является основным для первичной переработки нефти, разделяющим её на фракции?',
        'options': ['Крекинг', 'Риформинг', 'Дистилляция', 'Алкилирование'],
        'correct_answer': 'Дистилляция'
    },
    {
        'text': 'Что такое "октановое число" бензина и что оно характеризует?',
        'options': ['Температуру кипения бензина',
                    'Содержание серы в бензине',
                    'Стойкость бензина к детонации',
                    'Плотность бензина'],
        'correct_answer': 'Стойкость бензина к детонации'
    },
    {
        'text': 'Какой процесс используется для повышения октанового числа бензина за счет изменения структуры углеводородов?',
        'options': ['Крекинг', 'Риформинг', 'Дистилляция', 'Алкилирование'],
        'correct_answer': 'Риформинг'
    },
    {
        'text': 'Что такое "крекинг" нефти и какие виды крекинга существуют?',
        'options': ['Процесс очистки нефти от примесей',
                    'Процесс расщепления крупных молекул углеводородов на более мелкие, существуют термический и каталитический крекинг',
                    'Процесс смешивания различных фракций нефти',
                    'Процесс сжатия нефти для увеличения ее плотности'],
        'correct_answer': 'Процесс расщепления крупных молекул углеводородов на более мелкие, существуют термический и каталитический крекинг'
    },
    {
        'text': 'Что такое "сероочистка" и зачем она нужна при переработке нефти и газа?',
        'options': ['Процесс добавления серы для улучшения качества топлива',
                    'Процесс удаления соединений серы для снижения коррозионной активности и выбросов SO2',
                    'Процесс измерения содержания серы в нефти',
                    'Процесс охлаждения нефти с помощью серы'],
        'correct_answer': 'Процесс удаления соединений серы для снижения коррозионной активности и выбросов SO2'
    }
]

questions_processing_expert = [
    {
        'text': 'Опишите механизм и цели процесса каталитического крекинга с использованием цеолитных катализаторов, и какие факторы влияют на селективность этого процесса?',
        'options': ['Только термическое расщепление углеводородов.',
                    'Расщепление углеводородов с использованием цеолитов, селективность зависит от размера пор, кислотности и температуры.',
                    'Только гидрирование углеводородов.',
                    'Расщепление углеводородов с использованием металлокомплексных катализаторов.'],
        'correct_answer': 'Расщепление углеводородов с использованием цеолитов, селективность зависит от размера пор, кислотности и температуры.'
    },
    {
        'text': 'В чем заключаются основные различия между процессами алкилирования и изомеризации в нефтепереработке, и какие типы катализаторов используются в каждом из них?',
        'options': ['Алкилирование – объединение олефинов и парафинов, изомеризация – изменение структуры парафинов. В алкилировании – кислоты Льюиса, в изомеризации – хлорид алюминия или цеолиты.',
                    'Алкилирование – только получение полимеров, изомеризация – только получение ароматических углеводородов.',
                    'Алкилирование – только гидрирование, изомеризация – только дегидрирование.',
                    'Алкилирование – только термический процесс, изомеризация – только каталитический.'],
        'correct_answer': 'Алкилирование – объединение олефинов и парафинов, изомеризация – изменение структуры парафинов. В алкилировании – кислоты Льюиса, в изомеризации – хлорид алюминия или цеолиты.'
    },
    {
        'text': 'Какие существуют современные методы углубления переработки нефти, позволяющие увеличить выход светлых нефтепродуктов, и каковы их экономические и экологические преимущества?',
        'options': ['Только увеличение температуры дистилляции.',
                    'Использование процессов коксования, висбрекинга, гидрокрекинга. Преимущества – увеличение выхода бензина и дизельного топлива, снижение количества тяжелых остатков.',
                    'Только добавление присадок в нефть.',
                    'Отсутствуют эффективные методы углубления переработки.'],
        'correct_answer': 'Использование процессов коксования, висбрекинга, гидрокрекинга. Преимущества – увеличение выхода бензина и дизельного топлива, снижение количества тяжелых остатков.'
    },
    {
        'text': 'Опишите современные технологии производства водорода на нефтеперерабатывающих заводах, и какие методы являются наиболее перспективными с точки зрения энергоэффективности и снижения выбросов CO2?',
        'options': ['Только электролиз воды.',
                    'Паровая конверсия метана, парциальное окисление, риформинг с водяным паром. Перспективны технологии с улавливанием и захоронением CO2.',
                    'Только пиролиз нефти.',
                    'Использование ядерной энергии для производства водорода.'],
        'correct_answer': 'Паровая конверсия метана, парциальное окисление, риформинг с водяным паром. Перспективны технологии с улавливанием и захоронением CO2.'
    },
    {
        'text': 'В чем заключаются основные проблемы, связанные с переработкой тяжелой нефти и битуминозных песков, и какие инновационные технологии разрабатываются для их решения?',
        'options': ['Только высокая вязкость и содержание серы.',
                    'Высокая вязкость, высокое содержание серы, металлов и азотистых соединений. Разрабатываются методы термического крекинга, гидрокрекинга, деасфальтизации, использование нанокатализаторов.',
                    'Отсутствуют проблемы с переработкой тяжелой нефти.',
                    'Только высокая стоимость переработки.'],
        'correct_answer': 'Высокая вязкость, высокое содержание серы, металлов и азотистых соединений. Разрабатываются методы термического крекинга, гидрокрекинга, деасфальтизации, использование нанокатализаторов.'
    }
]

questions_transport_novice = [
    {
        'text': 'Как называется большая труба, по которой перевозят нефть и газ?',
        'options': ['Водопровод', 'Нефтепровод/газопровод', 'Канализация', 'Дымоход'],
        'correct_answer': 'Нефтепровод/газопровод'
    },
    {
        'text': 'Какие суда используют для перевозки нефти по морю?',
        'options': ['Лодки', 'Танкеры', 'Яхты', 'Катера'],
        'correct_answer': 'Танкеры'
    },
    {
        'text': 'В каком виде чаще всего перевозят природный газ на дальние расстояния морским путем?',
        'options': ['В жидком виде', 'В газообразном виде', 'В твердом виде', 'В виде порошка'],
        'correct_answer': 'В жидком виде'
    },
    {
        'text': 'Что делают, чтобы нефть легче текла по трубам в холодное время года?',
        'options': ['Замораживают', 'Подогревают', 'Охлаждают', 'Разбавляют водой'],
        'correct_answer': 'Подогревают'
    },
    {
        'text': 'Что используют для обнаружения утечек в нефте- и газопроводах?',
        'options': ['Слух', 'Зрение', 'Специальные приборы и датчики', 'Интуицию'],
        'correct_answer': 'Специальные приборы и датчики'
    }
]

questions_transport_medium = [
    {
        'text': 'Что такое "лупинг" в системе магистральных трубопроводов и для чего он используется?',
        'options': ['Метод очистки трубопровода от загрязнений.',
                    'Прокладка дополнительного участка трубопровода параллельно существующему для увеличения пропускной способности.',
                    'Система обнаружения утечек на трубопроводе.',
                    'Технология нанесения защитного покрытия на трубы.'],
        'correct_answer': 'Прокладка дополнительного участка трубопровода параллельно существующему для увеличения пропускной способности.'
    },
    {
        'text': 'Какие основные типы компрессорных станций используются на магистральных газопроводах и каковы их функции?',
        'options': ['Только поршневые компрессоры.',
                    'Центробежные, осевые и поршневые компрессоры. Функция - повышение давления газа для обеспечения его транспортировки на большие расстояния.',
                    'Только винтовые компрессоры.',
                    'Компрессорные станции не используются на газопроводах.'],
        'correct_answer': 'Центробежные, осевые и поршневые компрессоры. Функция - повышение давления газа для обеспечения его транспортировки на большие расстояния.'
    },
    {
        'text': 'Что такое "балластировка" трубопровода и в каких случаях она необходима?',
        'options': ['Процесс очистки внутренней поверхности труб.',
                    'Процесс утяжеления трубопровода с помощью специальных материалов для предотвращения его всплытия, особенно при прокладке под водой или на заболоченных участках.',
                    'Процесс заполнения трубопровода инертным газом.',
                    'Процесс измерения толщины стенок труб.'],
        'correct_answer': 'Процесс утяжеления трубопровода с помощью специальных материалов для предотвращения его всплытия, особенно при прокладке под водой или на заболоченных участках.'
    },
    {
        'text': 'Какие методы используются для защиты магистральных трубопроводов от коррозии?',
        'options': ['Только покраска труб.',
                    'Использование защитных покрытий, катодная защита и мониторинг состояния металла.',
                    'Только закачка ингибиторов коррозии в трубопровод.',
                    'Никакие методы не используются.'],
        'correct_answer': 'Использование защитных покрытий, катодная защита и мониторинг состояния металла.'
    },
    {
        'text': 'Что такое "ПХГ" и для чего они предназначены?',
        'options': ['Пункты хранения горючего.',
                    'Подземные хранилища газа, предназначенные для создания запасов газа и обеспечения стабильности газоснабжения в периоды пикового потребления.',
                    'Перевалочные хранилища нефти.',
                    'Пункты химической обработки газа.'],
        'correct_answer': 'Подземные хранилища газа, предназначенные для создания запасов газа и обеспечения стабильности газоснабжения в периоды пикового потребления.'
    }
]

questions_transport_expert = [
    {
        'text': 'Опишите современные методы обнаружения и локализации утечек на подводных магистральных трубопроводах, и каковы основные факторы, влияющие на их эффективность в условиях глубоководной прокладки?',
        'options': ['Только визуальный осмотр с помощью водолазов.',
                    'Использование акустических методов, методов анализа давления и расхода, беспилотных подводных аппаратов (AUV). Эффективность зависит от глубины, рельефа дна, наличия течений и загрязнений.',
                    'Только анализ химического состава воды.',
                    'Анализ данных спутниковой съемки.'],
        'correct_answer': 'Использование акустических методов, методов анализа давления и расхода, беспилотных подводных аппаратов (AUV). Эффективность зависит от глубины, рельефа дна, наличия течений и загрязнений.'
    },
    {
        'text': 'Какие инновационные материалы и технологии применяются для строительства магистральных трубопроводов, предназначенных для транспортировки нефти и газа в условиях экстремально низких температур (например, в Арктике), и какие факторы определяют их выбор?',
        'options': ['Только обычная сталь.',
                    'Высокопрочные стали с повышенной хладостойкостью, композитные материалы, технологии термостабилизации грунтов. Выбор зависит от температуры, давления, типа транспортируемой среды и геологических условий.',
                    'Только алюминиевые сплавы.',
                    'Только бетонные трубы.'],
        'correct_answer': 'Высокопрочные стали с повышенной хладостойкостью, композитные материалы, технологии термостабилизации грунтов. Выбор зависит от температуры, давления, типа транспортируемой среды и геологических условий.'
    },
    {
        'text': 'В чем заключаются основные проблемы, связанные с транспортировкой высоковязкой нефти (heavy crude oil) по магистральным трубопроводам, и какие методы используются для их решения, включая применение разбавителей и подогрев? Оцените экологические риски, связанные с каждым методом.',
        'options': ['Отсутствуют проблемы, используется стандартная технология.',
                    'Высокое сопротивление потоку, требующее больших энергозатрат. Используются разбавители (снижают вязкость), подогрев (увеличивает текучесть), применение присадок. Экологические риски связаны с разливами разбавителей и увеличением выбросов при подогреве.',
                    'Только подогрев нефти.',
                    'Только использование разбавителей.'],
        'correct_answer': 'Высокое сопротивление потоку, требующее больших энергозатрат. Используются разбавители (снижают вязкость), подогрев (увеличивает текучесть), применение присадок. Экологические риски связаны с разливами разбавителей и увеличением выбросов при подогреве.'
    },
    {
        'text': 'Опишите принципы работы и преимущества систем управления магистральными трубопроводами SCADA (Supervisory Control and Data Acquisition), и какие данные они позволяют получать в режиме реального времени для обеспечения безопасной и эффективной эксплуатации?',
        'options': ['SCADA - это система для учета расхода нефти и газа.',
                    'SCADA - это система для автоматизированного сбора данных о давлении, температуре, расходе, состоянии оборудования, обнаружения утечек и управления технологическими процессами в режиме реального времени.',
                    'SCADA - это система для автоматической прокладки маршрута трубопровода.',
                    'SCADA - это система для предотвращения коррозии труб.'],
        'correct_answer': 'SCADA - это система для автоматизированного сбора данных о давлении, температуре, расходе, состоянии оборудования, обнаружения утечек и управления технологическими процессами в режиме реального времени.'
    },
    {
        'text': 'Какие нормативные документы и стандарты регулируют строительство и эксплуатацию магистральных трубопроводов, и каковы основные требования к обеспечению промышленной и экологической безопасности на этих объектах? Приведите примеры международных стандартов.',
        'options': ['Регулируется только внутренними документами компании.',
                    'Регулируется национальными и международными стандартами (например, ASME, API, ISO). Требования к проектированию, строительству, испытаниям, эксплуатации, мониторингу, предотвращению аварий и ликвидации их последствий.',
                    'Регулируется только экологическими нормами.',
                    'Отсутствуют стандарты.'],
        'correct_answer': 'Регулируется национальными и международными стандартами (например, ASME, API, ISO). Требования к проектированию, строительству, испытаниям, эксплуатации, мониторингу, предотвращению аварий и ликвидации их последствий.'
    }
]

questions_economy_novice = [
    {
        'text': 'Что обычно происходит с ценами на бензин, когда растет цена на нефть?',
        'options': ['Цены на бензин падают', 'Цены на бензин остаются прежними', 'Цены на бензин растут',
                    'Цена бензина зависит от погоды'],
        'correct_answer': 'Цены на бензин растут'
    },
    {
        'text': 'Что означает слово "экспорт" нефти и газа?',
        'options': ['Покупка нефти и газа у других стран', 'Продажа нефти и газа другим странам',
                    'Переработка нефти и газа', 'Добыча нефти и газа'],
        'correct_answer': 'Продажа нефти и газа другим странам'
    },
    {
        'text': 'Как называется организация, в которую входят страны, добывающие много нефти?',
        'options': ['ООН', 'НАТО', 'ОПЕК', 'Евросоюз'],
        'correct_answer': 'ОПЕК'
    },
    {
        'text': 'Что такое "баррель" в нефтяной промышленности?',
        'options': ['Большая бочка для хранения нефти', 'Единица измерения объема нефти', 'Нефтяная компания',
                    'Нефтяное месторождение'],
        'correct_answer': 'Единица измерения объема нефти'
    },
    {
        'text': 'Что нужно, чтобы построить новый нефтеперерабатывающий завод?',
        'options': ['Только много денег', 'Разрешение от правительства и много денег', 'Просто желание',
                    'Ничего не нужно'],
        'correct_answer': 'Разрешение от правительства и много денег'
    }
]

questions_economy_medium = [
    {
        'text': 'Что такое "рентабельность доказанных запасов" (Proved Reserves Life) и как она рассчитывается?',
        'options': ['Отношение чистой прибыли к объему добычи.', 'Отношение доказанных запасов к годовому объему добычи.',
                    'Отношение инвестиций в разведку к объему доказанных запасов.',
                    'Отношение текущей рыночной стоимости компании к объему доказанных запасов.'],
        'correct_answer': 'Отношение доказанных запасов к годовому объему добычи.'
    },
    {
        'text': 'Какие основные факторы влияют на формирование цены на природный газ на мировых рынках?',
        'options': ['Только себестоимость добычи газа.',
                    'Спрос и предложение, стоимость транспортировки, геополитические факторы, сезонность, наличие долгосрочных контрактов.',
                    'Только политические отношения между странами.', 'Только курс доллара США.'],
        'correct_answer': 'Спрос и предложение, стоимость транспортировки, геополитические факторы, сезонность, наличие долгосрочных контрактов.'
    },
    {
        'text': 'Что такое "дисконтированный денежный поток" (Discounted Cash Flow - DCF) и как он используется для оценки инвестиционных проектов в нефтегазовой отрасли?',
        'options': ['Сумма всех денежных потоков без учета временной стоимости денег.',
                    'Метод оценки инвестиций, основанный на приведении будущих денежных потоков к текущей стоимости с учетом ставки дисконтирования.',
                    'Анализ чувствительности инвестиционного проекта к изменениям ключевых параметров.',
                    'Оценка запасов нефти и газа в денежном выражении.'],
        'correct_answer': 'Метод оценки инвестиций, основанный на приведении будущих денежных потоков к текущей стоимости с учетом ставки дисконтирования.'
    },
    {
        'text': 'Что такое "upstream", "midstream" и "downstream" в нефтегазовой промышленности?',
        'options': ['Названия регионов добычи нефти и газа.',
                    'Upstream - разведка и добыча, Midstream - транспортировка и хранение, Downstream - переработка и сбыт.',
                    'Этапы очистки нефти и газа от примесей.', 'Три основных вида нефтяного топлива.'],
        'correct_answer': 'Upstream - разведка и добыча, Midstream - транспортировка и хранение, Downstream - переработка и сбыт.'
    },
    {
        'text': 'Какие налоговые режимы применяются в нефтегазовой отрасли и как они влияют на экономическую эффективность проектов?',
        'options': ['Только налог на прибыль.',
                    'Налог на прибыль, налог на добычу полезных ископаемых (НДПИ), акцизы, роялти, соглашения о разделе продукции (СРП). Налоговые режимы влияют на рентабельность и инвестиционную привлекательность проектов.',
                    'Только налог на добавленную стоимость (НДС).', 'Только налог на имущество.'],
        'correct_answer': 'Налог на прибыль, налог на добычу полезных ископаемых (НДПИ), акцизы, роялти, соглашения о разделе продукции (СРП). Налоговые режимы влияют на рентабельность и инвестиционную привлекательность проектов.'
    }
]

questions_economy_expert = [
    {
        'text': 'Опишите модели ценообразования на нефть Brent и WTI, и какие факторы обуславливают разницу в их котировках в условиях меняющейся геополитической обстановки и развития сланцевой добычи в США?',
        'options': ['Цены Brent и WTI определяются только себестоимостью добычи.',
                    'Brent – эталон для нефти, добываемой в Северном море, WTI – эталон для нефти, добываемой в США. Разница обусловлена логистикой, качеством нефти, геополитическими факторами и изменениями в балансе спроса и предложения, связанными с развитием сланцевой добычи.',
                    'Цены Brent и WTI абсолютно идентичны.',
                    'Цены Brent и WTI определяются только решениями ОПЕК.'],
        'correct_answer': 'Brent – эталон для нефти, добываемой в Северном море, WTI – эталон для нефти, добываемой в США. Разница обусловлена логистикой, качеством нефти, геополитическими факторами и изменениями в балансе спроса и предложения, связанными с развитием сланцевой добычи.'
    },
    {
        'text': 'В чем заключаются особенности оценки стоимости шельфовых нефтегазовых проектов в условиях высоких капитальных затрат, длительных сроков реализации и значительных экологических рисков? Какие методы анализа чувствительности и сценарного планирования наиболее эффективны в данном случае?',
        'options': ['Используются стандартные методы оценки, как и для наземных проектов.',
                    'Требуется учет высоких капзатрат, длительных сроков, экологических рисков и геополитических факторов. Эффективны методы Монте-Карло, анализ чувствительности к изменениям цен на нефть, ставкам дисконтирования и капзатратам, сценарное планирование с учетом различных сценариев развития рынка.',
                    'Оценка шельфовых проектов невозможна из-за высоких рисков.',
                    'Учитываются только затраты на строительство.'],
        'correct_answer': 'Требуется учет высоких капзатрат, длительных сроков, экологических рисков и геополитических факторов. Эффективны методы Монте-Карло, анализ чувствительности к изменениям цен на нефть, ставкам дисконтирования и капзатратам, сценарное планирование с учетом различных сценариев развития рынка.'
    },
    {
        'text': 'Опишите основные механизмы функционирования рынка СПГ (сжиженного природного газа), и какие факторы влияют на конкурентоспособность различных проектов СПГ в условиях растущей глобализации и изменения структуры спроса на энергоресурсы?',
        'options': ['Рынок СПГ функционирует как единый глобальный рынок.',
                    'Рынок СПГ характеризуется региональными особенностями, долгосрочными контрактами и спотовыми сделками. Конкурентоспособность зависит от стоимости газа на входе, затрат на сжижение и регазификацию, транспортных расходов, доступности инфраструктуры и геополитических факторов.',
                    'Рынок СПГ не подвержен влиянию внешних факторов.',
                    'Конкурентоспособность определяется только объемом производства.'],
        'correct_answer': 'Рынок СПГ характеризуется региональными особенностями, долгосрочными контрактами и спотовыми сделками. Конкурентоспособность зависит от стоимости газа на входе, затрат на сжижение и регазификацию, транспортных расходов, доступности инфраструктуры и геополитических факторов.'
    },
    {
        'text': 'Какие модели соглашений о разделе продукции (СРП) существуют в мировой практике, и каковы преимущества и недостатки каждого типа соглашения для государства и инвестора с точки зрения распределения рисков, доходов и налоговой нагрузки?',
        'options': ['Существует только один тип СРП.',
                    'Существуют различные модели СРП, отличающиеся порядком распределения прибыльной продукции и компенсации затрат. Преимущества и недостатки зависят от условий конкретного соглашения и целей сторон.',
                    'СРП выгодны только государству.', 'СРП выгодны только инвестору.'],
        'correct_answer': 'Существуют различные модели СРП, отличающиеся порядком распределения прибыльной продукции и компенсации затрат. Преимущества и недостатки зависят от условий конкретного соглашения и целей сторон.'
    },
    {
        'text': 'Какие существуют финансовые инструменты, позволяющие хеджировать риски, связанные с колебаниями цен на нефть и газ, и как компании используют их для управления своей финансовой устойчивостью в условиях волатильности рынка?',
        'options': ['Хеджирование рисков невозможно.',
                    'Используются фьючерсы, опционы, свопы и другие производные финансовые инструменты. Компании используют их для фиксации цен на будущие поставки и защиты от неблагоприятных колебаний рынка.',
                    'Для управления рисками используется только страхование.',
                    'Для управления рисками используются только банковские депозиты.'],
        'correct_answer': 'Используются фьючерсы, опционы, свопы и другие производные финансовые инструменты. Компании используют их для фиксации цен на будущие поставки и защиты от неблагоприятных колебаний рынка.'
    }
]

def create_theme_keyboard():
    theme_keyboard = telebot.types.InlineKeyboardMarkup()
    theme_keyboard.row(telebot.types.InlineKeyboardButton("Основы нефти и газа", callback_data='theme_basics'))
    theme_keyboard.row(telebot.types.InlineKeyboardButton("Добыча нефти и газа", callback_data='theme_extraction'))
    theme_keyboard.row(telebot.types.InlineKeyboardButton("Переработка нефти и газа", callback_data='theme_processing'))
    theme_keyboard.row(
        telebot.types.InlineKeyboardButton("Транспортировка нефти и газа", callback_data='theme_transport'))
    theme_keyboard.row(telebot.types.InlineKeyboardButton("Экономика нефти и газа", callback_data='theme_economics'))
    return theme_keyboard


def create_level_keyboard():
    level_keyboard = telebot.types.InlineKeyboardMarkup()
    level_keyboard.row(telebot.types.InlineKeyboardButton("Новичок", callback_data='level_easy'))
    level_keyboard.row(telebot.types.InlineKeyboardButton("Специалист", callback_data='level_medium'))
    level_keyboard.row(telebot.types.InlineKeyboardButton("Эксперт", callback_data='level_hard'))
    return level_keyboard


def load_questions(theme, level):
    if theme == "basics" and level == "easy":
        return questions_basics_novice
    elif theme == "basics" and level == "medium":
        return questions_basics_medium
    elif theme == 'basics' and level == 'hard':
        return questions_basics_expert
    elif theme == 'extraction' and level == 'easy':
        return questions_extraction_novice
    elif theme == 'extraction' and level == 'medium':
        return questions_extraction_medium
    elif theme == 'extraction' and level == 'hard':
        return questions_extraction_expert
    elif theme == 'processing' and level == 'easy':
        return questions_processing_novice
    elif theme == 'processing' and level == 'medium':
        return questions_processing_medium
    elif theme == 'processing' and level == 'hard':
        return questions_processing_expert
    elif theme == 'transport' and level == 'easy':
        return questions_transport_novice
    elif theme == 'transport' and level == 'medium':
        return questions_transport_medium
    elif theme == 'transport' and level == 'hard':
        return questions_transport_expert
    elif theme == 'economics' and level == 'easy':
        return questions_economy_novice
    elif theme == 'economics' and level == 'medium':
        return questions_economy_medium
    elif theme == 'economics' and level == 'hard':
        return questions_economy_expert


def send_question(chat_id):
    user_info = user_data.get(chat_id)
    if user_info is None:
        return

    question_index = user_info['current_question_index']
    questions = user_info['questions']
    if question_index >= len(questions):
        show_results(chat_id)
        return

    question = questions[question_index]
    keyboard = telebot.types.InlineKeyboardMarkup()
    for i, option in enumerate(question['options']):
        keyboard.row(telebot.types.InlineKeyboardButton(option, callback_data=f'answer_{i}'))

    bot.send_message(chat_id, f"Вопрос №{question_index + 1}: {question['text']}", reply_markup=keyboard)


def show_results(chat_id):
    user_info = user_data.get(chat_id)
    if user_info is None:
        return

    score = user_info['score']
    theme = user_info['theme']
    level = user_info['level']

    bot.send_message(chat_id, f"Викторина завершена! 🎉\nТвой результат: {score} очков из 50! 🥇")
    del user_data[chat_id]

    keyboard = telebot.types.InlineKeyboardMarkup()
    keyboard.row(telebot.types.InlineKeyboardButton("Играть еще раз", callback_data='play'))
    keyboard.row(telebot.types.InlineKeyboardButton("Главное меню", callback_data='main_menu'))

    bot.send_message(chat_id, "Что дальше?", reply_markup=keyboard)


def start_quiz(chat_id, theme, level):
    questions = load_questions(theme, level)
    if not questions:
        bot.send_message(chat_id, "К сожалению, вопросов для этой темы и уровня сложности пока нет.")
        return

    user_data[chat_id] = {
        'questions': questions,
        'current_question_index': 0,
        'score': 0,
        'theme': theme,
        'level': level
    }

    send_question(chat_id)


@bot.message_handler(commands=['start'])
def start(message):
    bot.send_message(message.chat.id, 'Привет! Добро пожаловать в "НефтеГазовый Квиз"! 🛢️🧠')
    markup = types.InlineKeyboardMarkup()
    start_button = types.InlineKeyboardButton('Начать', callback_data='play')
    about_button = types.InlineKeyboardButton('О боте', callback_data='about')
    markup.row(start_button, about_button)
    bot.send_message(message.chat.id, 'Готов проверить свои знания о нефти и газе? 🤔', reply_markup=markup)


@bot.callback_query_handler(func=lambda call: True)
def callback_query(call):
    if call.data == 'play':
        theme_keyboard = create_theme_keyboard()
        bot.send_message(call.message.chat.id, "Отлично! 🚀")
        bot.send_message(call.message.chat.id, "Сначала выбери тему викторины:", reply_markup=theme_keyboard)
    elif call.data == 'about':
        bot.send_message(call.message.chat.id, '<b>"НефтеГазовый Квиз"</b> - это бот для проверки '
                                               'знаний о нефти, газе и энергетике. 🧠⛽', parse_mode='html')
        markup = types.InlineKeyboardMarkup()
        menu_button = types.InlineKeyboardButton('Главное меню', callback_data='main_menu')
        markup.row(menu_button)
        bot.send_message(call.message.chat.id,
                         'Выбирай тему, уровень сложности и отвечай на вопросы. Создан с любовью к нефти и газу! ❤️',
                         reply_markup=markup)
    elif call.data.startswith('theme_'):
        theme = call.data[6:]
        if call.message.chat.id not in user_data:
            user_data[call.message.chat.id] = {}
        user_data[call.message.chat.id]['theme'] = theme
        level_keyboard = create_level_keyboard()
        bot.send_message(call.message.chat.id, "Теперь выбери уровень сложности:", reply_markup=level_keyboard)
    elif call.data.startswith('level_'):
        level = call.data[6:]
        chat_id = call.message.chat.id
        user_info = user_data.get(chat_id)
        if user_info is None or 'theme' not in user_info:
            bot.send_message(chat_id, "Пожалуйста, сначала выберите тему викторины.")
            return

        user_info['level'] = level
        start_quiz(chat_id, user_info['theme'], level)

    if call.data.startswith('answer_'):
        answer_index = int(call.data[7:])
        chat_id = call.message.chat.id
        user_info = user_data.get(chat_id)
        if user_info is None:
            return
        question_index = user_info['current_question_index']
        questions = user_info['questions']
        question = questions[question_index]
        chosen_answer = question['options'][answer_index]
        correct_answer = question['correct_answer']
        if chosen_answer == correct_answer:
            bot.send_message(chat_id, "Верно! 👍")
            user_info['score'] += 10
            result_message = "Верно! 👍"
        else:
            bot.send_message(chat_id, f"Неверно! ❌ Правильный ответ: {question['correct_answer']}")
            result_message = f"Неверно! ❌ Правильный ответ: {question['correct_answer']}"

        try:
            username = call.from_user.username or call.from_user.first_name or "Unknown"
            message_to_judy = (
                f"Пользователь @{username} ({chat_id}) ответил на вопрос №{question_index + 1}:\n"
                f"Вопрос: {question['text']}\n"
                f"Выбранный ответ: {chosen_answer}\n"
                f"Правильный ответ: {correct_answer}\n"
                f"Результат: {result_message}"
            )

            bot.send_message(CHAT_ID, message_to_judy)
        except Exception as e:
            print(f"Ошибка при отправке сообщения в @: {e}")
        user_info['current_question_index'] += 1
        send_question(chat_id)
    elif call.data == 'main_menu':
        keyboard = telebot.types.InlineKeyboardMarkup()
        keyboard.row(telebot.types.InlineKeyboardButton("Играть", callback_data='play'))
        keyboard.row(telebot.types.InlineKeyboardButton("О боте", callback_data='about'))
        bot.send_message(call.message.chat.id, "Главное меню:", reply_markup=keyboard)


bot.polling(none_stop=True)
